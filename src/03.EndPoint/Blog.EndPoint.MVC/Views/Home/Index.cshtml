@using Blog.Domain.Core.Dtos.PostDtos
@using Blog.FrameWork
@model List<ShowPostDto>
@{
	Layout = "";
}

<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>خانه</title>
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css">
	<style>
		body {
			font-family: Vazir, sans-serif;
			background-color: #3b4a6b;
			color: #fff;
			margin: 0;
		}

		#sidebar {
			position: fixed;
			right: 0;
			top: 0;
			width: 200px;
			height: 100vh;
			background-color: #526180;
			transition: width 0.3s;
			display: flex;
			flex-direction: column;
			justify-content: space-between;
			padding-top: 10px;
		}

			#sidebar.collapsed {
				width: 60px;
			}

			#sidebar .menu-item {
				padding: 12px 15px;
				color: #fff;
				cursor: pointer;
				display: flex;
				align-items: center;
				border-radius: 8px;
				margin: 5px 10px;
				font-size: 0.95rem;
			}

				#sidebar .menu-item:hover {
					background-color: rgba(255,140,66,0.2);
				}

				#sidebar .menu-item i {
					font-size: 1.2rem;
					margin-left: 8px;
					color: #ff8c42;
				}

			#sidebar.collapsed .menu-item span {
				display: none;
			}

			#sidebar .logout {
				background-color: #f87171;
				text-align: center;
				padding: 8px;
				margin: 10px;
				border-radius: 6px;
				font-size: 0.9rem;
				cursor: pointer;
			}

				#sidebar .logout:hover {
					background-color: #e55b5b;
				}

		#toggle-btn {
			position: absolute;
			left: 0;
			top: 0;
			width: 25px;
			height: 100%;
			background-color: #394263;
			display: flex;
			align-items: center;
			justify-content: center;
			cursor: pointer;
			font-size: 1.2rem;
		}

		#main-content {
			margin-right: 200px;
			padding: 20px;
			transition: margin-right 0.3s;
		}

		#sidebar.collapsed ~ #main-content {
			margin-right: 60px;
		}

		#welcome-text {
			font-size: 1.1rem;
			margin-bottom: 15px;
		}

		#filter-section {
			margin-bottom: 20px;
			width: 200px;
		}

			#filter-section input {
				font-size: 0.85rem;
				padding: 5px 8px;
				color: #fff;
				background-color: #394263;
				border: none;
				border-radius: 5px;
			}

				#filter-section input::placeholder {
					color: #ffd580;
				}

			#filter-section button {
				padding: 5px 10px;
				font-size: 0.85rem;
			}

		#posts-container {
			display: grid;
			grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
			gap: 15px;
		}

		.post-card {
			background-color: #526180;
			border-radius: 12px;
			overflow: hidden;
			transition: all 0.3s;
			display: flex;
			flex-direction: column;
		}

		#sidebar.collapsed ~ #main-content .post-card {
			min-height: 300px;
		}

		.post-img {
			width: 100%;
			height: 180px;
			object-fit: cover;
		}

		.post-title {
			font-size: 1rem;
			font-weight: bold;
			padding: 8px;
		}

		.post-desc {
			font-size: 0.85rem;
			padding: 0 8px 8px 8px;
		}

		.post-meta {
			font-size: 0.8rem;
			color: #ffd580;
			padding: 0 8px 8px 8px;
		}

		.show-more {
			cursor: pointer;
			color: #ff8c42;
			text-decoration: underline;
			font-size: 0.8rem;
		}
	</style>
</head>
<body>

	<div id="sidebar">
		<div>
			<div id="toggle-btn">&#9776;</div>
			<div class="menu-item" onclick="location.href='/Post/Management'">
				<i class="bi bi-file-text"></i>
				<span>پست‌ها</span>
			</div>
			<div class="menu-item" onclick="location.href='/Category/Index'">
				<i class="bi bi-list-ul"></i>
				<span>دسته‌بندی‌ها</span>
			</div>
			<div class="menu-item" onclick="location.href='/Comment/Index'">
				<i class="bi bi-list-ul"></i>
				<span>‌کامنت ها</span>
			</div>
		</div>
		<div class="logout" onclick="location.href='/Account/Logout'">خروج ⬅️</div>
	</div>

	<div id="main-content">
		<div id="welcome-text">👋 خوش آمدید! شما می‌توانید پست‌های دیگران را مشاهده کنید.</div>

		<div id="filter-section">
			<form method="get" action="/Home/Index" class="d-flex">
				<input type="text"
					   name="categorytitle"
					   placeholder="جستجو بر اساس دسته‌بندی"
				<button type="submit" class="btn btn-sm btn-primary ms-2">🔍</button>
			</form>
		</div>

		<div id="posts-container">
			@if (Model != null && Model.Count > 0)
			{
				@foreach (var post in Model)
				{
					var shortDesc = post.Description.Length > 120 ? post.Description.Substring(0, 120) + "..." : post.Description;
					<div class="post-card">
						<a href="/Post/Details/@post.Id" style="text-decoration:none; color:inherit;">
							@if (!string.IsNullOrEmpty(post.Profile))
							{
								<img src="@post.Profile" class="post-img" />
							}
							<div class="post-title">@post.Title</div>
							<div class="post-desc">
								<span class="desc-short">@shortDesc</span>
								@if (post.Description.Length > 80)
								{
									<a href="#" class="show-more" onclick="showFullDesc(event)">ادامه</a>
									<span class="desc-full d-none">@post.Description</span>
								}
							</div>
							<div class="post-meta">@post.CategoryTitle | @post.CreateAt.ToPersianDate()</div>
						</a>
					</div>
				}
			}
			else
			{
				<h3 style="text-align:center; color:#f87171;">هیچ پستی یافت نشد.</h3>
			}
		</div>
	</div>

	<script>
		const sidebar = document.getElementById('sidebar');
		const toggleBtn = document.getElementById('toggle-btn');
		toggleBtn.addEventListener('click', () => { sidebar.classList.toggle('collapsed'); });

		function showFullDesc(e){
			e.preventDefault();
			const link = e.target;
			const shortDesc = link.previousElementSibling;
			const fullDesc = link.nextElementSibling;
			shortDesc.textContent = fullDesc.textContent;
			link.remove();
		}
	</script>

</body>
</html>




